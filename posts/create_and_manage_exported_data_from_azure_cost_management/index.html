<!doctype html>
<html lang="en-us">
  <head>
    <title>Create and Manage Exported Data from Azure Cost Management // mangoldai :: cloud architect insights</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.92.2" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/mangoldaiwiki/css/main.min.d18c46a9c052e3fff4ff60ea22fff43c74140b8b952b4bbebd229127fbf997f3.css" />
    

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Create and Manage Exported Data from Azure Cost Management"/>
<meta name="twitter:description" content="If you read the Cost Analysis tutorial, then you&rsquo;re familiar with manually downloading your Cost Management data. However, you can create a recurring task that automatically exports your Cost Management data to Azure storage on a daily, weekly, or monthly basis. Exported data is in CSV format and it contains all the information that Cost Management collects. You can then use the exported data in Azure storage with external systems and combine it with your own custom data."/>

    <meta property="og:title" content="Create and Manage Exported Data from Azure Cost Management" />
<meta property="og:description" content="If you read the Cost Analysis tutorial, then you&rsquo;re familiar with manually downloading your Cost Management data. However, you can create a recurring task that automatically exports your Cost Management data to Azure storage on a daily, weekly, or monthly basis. Exported data is in CSV format and it contains all the information that Cost Management collects. You can then use the exported data in Azure storage with external systems and combine it with your own custom data." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jmangold23.github.io/mangoldaiwiki/posts/create_and_manage_exported_data_from_azure_cost_management/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-06-10T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-06-10T00:00:00+00:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://jmangold23.github.io/mangoldaiwiki/"><img class="app-header-avatar" src="/mangoldaiwiki/avatar.jpg" alt="John Doe" /></a>
      <span class="app-header-title">mangoldai :: cloud architect insights</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/mangoldaiwiki/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/mangoldaiwiki/tags/">Tags</a>
      </nav>
      <p>Cloud architecture, Azure, and tech innovations. Notes, tips, and insights.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/jmangold23" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>My Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://www.linkedin.com/in/joshua-mangold-a7ba0989/" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>My LinkedIn</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Create and Manage Exported Data from Azure Cost Management</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jun 10, 2024
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          9 min read
        </div>
      </div>
    </header>
    <div class="post-content">
      <p>If you read the Cost Analysis tutorial, then you&rsquo;re familiar with manually downloading your Cost Management data. However, you can create a recurring task that automatically exports your Cost Management data to Azure storage on a daily, weekly, or monthly basis. Exported data is in CSV format and it contains all the information that Cost Management collects. You can then use the exported data in Azure storage with external systems and combine it with your own custom data. And you can use your exported data in an external system like a dashboard or other financial system.</p>
<p>Watch the <a href="https://www.youtube.com/watch?v=rWa_xI1aRzo">How to schedule exports to storage with Azure Cost Management</a> video about creating a scheduled export of your Azure cost data to Azure Storage. To watch other videos, visit the <a href="https://www.youtube.com/c/AzureCostManagement">Azure Cost Management YouTube channel</a>.</p>
<p>The examples in this tutorial walk you through exporting your cost management data and then verify that the data was successfully exported.</p>
<p>In this tutorial, you will learn how to:</p>
<ul>
<li>Create a daily export</li>
<li>Verify that data is collected</li>
</ul>
<h2 id="prerequisites">Prerequisites</h2>
<p>Data export is available for various Azure account types, including <a href="https://azure.microsoft.com/pricing/enterprise-agreement/">Enterprise Agreement (EA)</a> and <a href="get-started-partners.md">Microsoft Customer Agreement</a> customers. To view the full list of supported account types, see <a href="understand-cost-mgt-data.md">Understand Azure Cost Management data</a>. The following Azure permissions, or scopes, are supported per subscription for data export by user and group. For more information about scopes, see <a href="understand-work-scopes.md">Understand and work with scopes</a>.</p>
<ul>
<li>Owner - Can create, modify, or delete scheduled exports for a subscription.</li>
<li>Contributor - Can create, modify, or delete their own scheduled exports. Can modify the name of scheduled exports created by others.</li>
<li>Reader - Can schedule exports that they have permission to.
<ul>
<li><strong>For more information about scopes, including access needed to configure exports for Enterprise Agreement and Microsoft Customer agreement scopes, see <a href="understand-work-scopes.md">Understand and work with scopes</a></strong>.</li>
</ul>
</li>
</ul>
<p>For Azure Storage accounts:</p>
<ul>
<li>Write permissions are required to change the configured storage account, independent of permissions on the export.</li>
<li>Your Azure storage account must be configured for blob or file storage.</li>
<li>Don&rsquo;t configure exports to a storage container when configured as a destination in an <a href="../../storage/blobs/object-replication-overview.md#object-replication-policies-and-rules">object replication rule</a>.</li>
<li>To export to storage accounts with configured firewalls, you need other privileges on the storage account. The other privileges are only required during export creation or modification. They are:
<ul>
<li>Owner role on the storage account.
Or</li>
<li>Any custom role with <code>Microsoft.Authorization/roleAssignments/write</code> and <code>Microsoft.Authorization/permissions/read</code> permissions.
Additionally, ensure that you enable <a href="../../storage/common/storage-network-security.md#grant-access-to-trusted-azure-services">Allow trusted Azure service access</a> to the storage account when you configure the firewall. If you want to use the <a href="/rest/api/cost-management/exports">Exports REST API</a> to generate exports to a storage account located behind a firewall, use the API version 2023-08-01 or later version. All newer API versions continue to support exports behind the firewall.</li>
</ul>
</li>
<li>The storage account configuration must have the <strong>Permitted scope for copy operations (preview)</strong> option set to <strong>From any storage account</strong>.
:::image type=&ldquo;content&rdquo; source=&quot;./media/tutorial-export-acm-data/permitted-scope-copy-operations.png&quot; alt-text=&ldquo;Screenshot showing From any storage account option set.&rdquo; lightbox=&quot;./media/tutorial-export-acm-data/permitted-scope-copy-operations.png&quot; :::</li>
</ul>
<p>If you have a new subscription, you can&rsquo;t immediately use Azure Cost Management features. It might take up to 48 hours before you can use all Azure Cost Management features.</p>
<h2 id="sign-in-to-azure">Sign in to Azure</h2>
<p>Sign in to the Azure portal at <a href="https://portal.azure.com/">https://portal.azure.com</a>.</p>
<h2 id="create-a-daily-export">Create a daily export</h2>
<h3 id="portaltabazure-portal"><a href="#tab/azure-portal">Portal</a></h3>
<p>To create or view a data export or to schedule an export, choose a scope in the Azure portal and select <strong>Cost analysis</strong> in the menu. For example, navigate to <strong>Subscriptions</strong>, select a subscription from the list, and then select <strong>Cost analysis</strong> in the menu. At the top of the Cost analysis page, select <strong>Configure subscription</strong>, then <strong>Exports</strong>.</p>
<blockquote>
<p>[!NOTE]</p>
<ul>
<li>Besides subscriptions, you can create exports on resource groups, management groups, departments, and enrollments. For more information about scopes, see <a href="understand-work-scopes.md">Understand and work with scopes</a>.</li>
<li>When you&rsquo;re signed in as a partner at the billing account scope or on a customer&rsquo;s tenant, you can export data to an Azure Storage account that&rsquo;s linked to your partner storage account. However, you must have an active subscription in your CSP tenant.</li>
</ul>
</blockquote>
<ol>
<li>Select <strong>Create</strong></li>
<li>For <strong>Export details</strong>, make a selection:
<ul>
<li>Type a name for export</li>
<li><strong>Daily export of month-to-date costs</strong> - Provides a new export file daily for your month-to-date costs. The latest data is aggregated from previous daily exports.</li>
<li><strong>Weekly export of cost for the last seven days</strong> - Creates a weekly export of your costs for the past seven days from the selected start date of your export.</li>
<li><strong>Monthly export of last month&rsquo;s costs</strong> - Provides you with an export of your last month&rsquo;s costs compared to the current month that you create the export. Afterward, the schedule runs an export on the fifth day of every new month with your previous months costs.</li>
<li><strong>One-time export</strong> - Allows you to choose a date range for historical data to export to Azure blob storage. You can export a maximum of 90 days of historical costs from the day you choose. This export runs immediately and is available in your storage account within two hours.
Depending on your export type, either choose a start date, or choose a <strong>From</strong> and <strong>To</strong> date.</li>
</ul>
</li>
<li>Specify the subscription for your Azure storage account, then select a resource group or create a new one.</li>
<li>Select the storage account name or create a new one.</li>
<li>Select the location (Azure region).</li>
<li>Specify the storage container and the directory path that you&rsquo;d like the export file to go to.
:::image type=&ldquo;content&rdquo; source=&quot;./media/tutorial-export-acm-data/basics_exports.png&quot; alt-text=&ldquo;Screenshot showing the New export page where you configure an export.&rdquo; lightbox=&quot;./media/tutorial-export-acm-data/basics_exports.png&quot;:::</li>
<li>Review your export details and select <strong>Create</strong>.</li>
</ol>
<p>Your new export appears in the list of exports. By default, new exports are enabled. If you want to disable or delete a scheduled export, select any item in the list, and then select either <strong>Disable</strong> or <strong>Delete</strong>.</p>
<p>Initially, it can take 12-24 hours before the export runs. However, it can take up longer before data is shown in exported files.</p>
<h3 id="azure-clitabazure-cli"><a href="#tab/azure-cli">Azure CLI</a></h3>
<p>When you create an export programmatically, you must manually register the <code>Microsoft.CostManagementExports</code> resource provider with the subscription where the storage account resides. Registration happens automatically when you create the export using the Azure portal. For more information about how to register resource providers, see <a href="../../azure-resource-manager/management/resource-providers-and-types.md#register-resource-provider">Register resource provider</a>.</p>
<p>Start by preparing your environment for the Azure CLI:</p>
<p>[!INCLUDE <a href="~/reusable-content/azure-cli/azure-cli-prepare-your-environment-no-header.md">azure-cli-prepare-your-environment-no-header.md</a>]</p>
<ol>
<li>
<p>After you sign in, to see your current exports, use the <a href="/cli/azure/costmanagement/export#az-costmanagement-export-list">az costmanagement export list</a> command:</p>
<pre tabindex="0"><code class="language-azurecli" data-lang="azurecli">az costmanagement export list --scope &quot;subscriptions/00000000-0000-0000-0000-000000000000&quot;
</code></pre><blockquote>
<p>[!NOTE]</p>
<ul>
<li>Besides subscriptions, you can create exports for resource groups and management groups. For more information about scopes, see <a href="understand-work-scopes.md">Understand and work with scopes</a>.</li>
<li>When you&rsquo;re signed in as a partner at the billing account scope or on a customer&rsquo;s tenant, you can export data to an Azure Storage account that&rsquo;s linked to your partner storage account. However, you must have an active subscription in your CSP tenant.</li>
</ul>
</blockquote>
</li>
<li>
<p>Create a resource group or use an existing resource group. To create a resource group, use the <a href="/cli/azure/group#az-group-create">az group create</a> command:</p>
<pre tabindex="0"><code class="language-azurecli" data-lang="azurecli">az group create --name TreyNetwork --location &quot;East US&quot;
</code></pre></li>
<li>
<p>Create a storage account to receive the exports or use an existing storage account. To create a storage account, use the <a href="/cli/azure/storage/account#az-storage-account-create">az storage account create</a> command:</p>
<pre tabindex="0"><code class="language-azurecli" data-lang="azurecli">az storage account create --resource-group TreyNetwork --name cmdemo
</code></pre></li>
<li>
<p>Run the <a href="/cli/azure/costmanagement/export#az-costmanagement-export-create">az costmanagement export create</a> command to create the export:</p>
<pre tabindex="0"><code class="language-azurecli" data-lang="azurecli">az costmanagement export create --name DemoExport --type ActualCost \
--scope &quot;subscriptions/00000000-0000-0000-0000-000000000000&quot; \
--storage-account-id /subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/TreyNetwork/providers/Microsoft.Storage/storageAccounts/cmdemo \
--storage-container democontainer --timeframe MonthToDate --recurrence Daily \
--recurrence-period from=&quot;2020-06-01T00:00:00Z&quot; to=&quot;2020-10-31T00:00:00Z&quot; \
--schedule-status Active --storage-directory demodirectory
</code></pre><p>For the <code>--type</code> parameter, you can choose <code>ActualCost</code>, <code>AmortizedCost</code>, or <code>Usage</code>.</p>
<p>This example uses <code>MonthToDate</code>. The export creates an export file daily for your month-to-date costs. The latest data is aggregated from previous daily exports this month.</p>
</li>
<li>
<p>To see the details of your export operation, use the <a href="/cli/azure/costmanagement/export#az-costmanagement-export-show">az costmanagement export show</a> command:</p>
<pre tabindex="0"><code class="language-azurecli" data-lang="azurecli">az costmanagement export show --name DemoExport \
   --scope &quot;subscriptions/00000000-0000-0000-0000-000000000000&quot;
</code></pre></li>
<li>
<p>Update an export by using the <a href="/cli/azure/costmanagement/export#az-costmanagement-export-update">az costmanagement export update</a> command:</p>
<pre tabindex="0"><code class="language-azurecli" data-lang="azurecli">az costmanagement export update --name DemoExport \
   --scope &quot;subscriptions/00000000-0000-0000-0000-000000000000&quot; --storage-directory demodirectory02
</code></pre><p>This example changes the output directory.</p>
</li>
</ol>
<blockquote>
<p>[!NOTE]
Initially, it can take 12-24 hours before the export runs. However, it can take longer before data is shown in exported files.</p>
</blockquote>
<p>You can delete an export by using the <a href="/cli/azure/costmanagement/export#az-costmanagement-export-delete">az costmanagement export delete</a> command:</p>
<pre tabindex="0"><code class="language-azurecli" data-lang="azurecli">az costmanagement export delete --name DemoExport --scope &quot;subscriptions/00000000-0000-0000-0000-000000000000&quot;
</code></pre><h3 id="azure-powershelltabazure-powershell"><a href="#tab/azure-powershell">Azure PowerShell</a></h3>
<p>When you create an export programmatically, you must manually register the <code>Microsoft.CostManagementExports</code> resource provider with the subscription where the storage account resides. Registration happens automatically when you create the export using the Azure portal. For more information about how to register resource providers, see <a href="../../azure-resource-manager/management/resource-providers-and-types.md#register-resource-provider">Register resource provider</a>.</p>
<p>Start by preparing your environment for Azure PowerShell:</p>
<p>[!INCLUDE <a href="~/reusable-content/ce-skilling/azure/includes/azure-powershell-requirements-no-header.md">azure-powershell-requirements-no-header.md</a>]</p>
<blockquote>
<p>[!IMPORTANT]
While the <strong>Az.CostManagement</strong> PowerShell module is in preview, you must install it separately
using the <code>Install-Module</code> cmdlet. After this PowerShell module becomes generally available, it
will be part of future Az PowerShell module releases and available by default from within Azure
Cloud Shell.</p>
</blockquote>
<pre tabindex="0"><code class="language-azurepowershell-interactive" data-lang="azurepowershell-interactive">Install-Module -Name Az.CostManagement
</code></pre><ol>
<li>
<p>After you sign in, to see your current exports, use the <a href="/powershell/module/Az.CostManagement/get-azcostmanagementexport">Get-AzCostManagementExport</a> cmdlet:</p>
<pre tabindex="0"><code class="language-azurepowershell-interactive" data-lang="azurepowershell-interactive">Get-AzCostManagementExport -Scope 'subscriptions/00000000-0000-0000-0000-000000000000'
</code></pre><blockquote>
<p>[!NOTE]</p>
<ul>
<li>Besides subscriptions, you can create exports for resource groups and management groups. For more information about scopes, see <a href="understand-work-scopes.md">Understand and work with scopes</a>.</li>
<li>When you&rsquo;re signed in as a partner at the billing account scope or on a customer&rsquo;s tenant, you can export data to an Azure Storage account that&rsquo;s linked to your partner storage account. However, you must have an active subscription in your CSP tenant.</li>
</ul>
</blockquote>
</li>
<li>
<p>Create a resource group or use an existing resource group. To create a resource group, use the <a href="/powershell/module/az.resources/new-azresourcegroup">New-AzResourceGroup</a> cmdlet:</p>
<pre tabindex="0"><code class="language-azurepowershell-interactive" data-lang="azurepowershell-interactive">New-AzResourceGroup -Name TreyNetwork -Location eastus
</code></pre></li>
<li>
<p>Create a storage account to receive the exports or use an existing storage account. To create a storage account, use the <a href="/powershell/module/az.storage/new-azstorageaccount">New-AzStorageAccount</a> cmdlet:</p>
<pre tabindex="0"><code class="language-azurepowershell-interactive" data-lang="azurepowershell-interactive">New-AzStorageAccount -ResourceGroupName TreyNetwork -AccountName cmdemo -SkuName Standard_RAGRS -Location eastus
</code></pre></li>
<li>
<p>Run the <a href="/powershell/module/Az.CostManagement/new-azcostmanagementexport">New-AzCostManagementExport</a> cmdlet to create the export:</p>
<pre tabindex="0"><code class="language-azurepowershell-interactive" data-lang="azurepowershell-interactive">$Params = @{
  Name = 'DemoExport'
  DefinitionType = 'ActualCost'
  Scope = 'subscriptions/00000000-0000-0000-0000-000000000000'
  DestinationResourceId = '/subscriptions/00000000-0000-0000-0000-000000000000/resourceGroups/treynetwork/providers/Microsoft.Storage/storageAccounts/cmdemo'
  DestinationContainer = 'democontainer'
  DefinitionTimeframe = 'MonthToDate'
  ScheduleRecurrence = 'Daily'
  RecurrencePeriodFrom = '2020-06-01T00:00:00Z'
  RecurrencePeriodTo = '2020-10-31T00:00:00Z'
  ScheduleStatus = 'Active'
  DestinationRootFolderPath = 'demodirectory'
  Format = 'Csv'
}
New-AzCostManagementExport @Params
</code></pre><p>For the <strong>DefinitionType</strong> parameter, you can choose <code>ActualCost</code>, <code>AmortizedCost</code>, or <code>Usage</code>.</p>
<p>This example uses <code>MonthToDate</code>. The export creates an export file daily for your month-to-date costs. The latest data is aggregated from previous daily exports this month.</p>
</li>
<li>
<p>To see the details of your export operation, use the <code>Get-AzCostManagementExport</code> cm</p>
</li>
</ol>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
