<!doctype html>
<html lang="en-us">
  <head>
    <title>Powershell-SlackBot- Harnessing the Power of the Slack Real-Time Messaging API // mangoldai :: cloud architect insights</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.92.2" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/mangoldaiwiki/css/main.min.d18c46a9c052e3fff4ff60ea22fff43c74140b8b952b4bbebd229127fbf997f3.css" />
    

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Powershell-SlackBot- Harnessing the Power of the Slack Real-Time Messaging API"/>
<meta name="twitter:description" content="Powershell-SlackBot: Harnessing the Power of the Slack Real-Time Messaging API This project is a PowerShell implementation of a Chat Bot for Slack that utilises the Slack Real Time Messaging (RTM) API. This code is intended to provide a simple framework for anyone that wants to write a Chat Bot for a single Slack Team that is able to respond to Channel and Direct Messages. It would also be simple to extend the code to permit the Bot to respond to any other events exposed via the RTM API."/>

    <meta property="og:title" content="Powershell-SlackBot- Harnessing the Power of the Slack Real-Time Messaging API" />
<meta property="og:description" content="Powershell-SlackBot: Harnessing the Power of the Slack Real-Time Messaging API This project is a PowerShell implementation of a Chat Bot for Slack that utilises the Slack Real Time Messaging (RTM) API. This code is intended to provide a simple framework for anyone that wants to write a Chat Bot for a single Slack Team that is able to respond to Channel and Direct Messages. It would also be simple to extend the code to permit the Bot to respond to any other events exposed via the RTM API." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jmangold23.github.io/mangoldaiwiki/posts/powershell-slackbot_harnessing_the_power_of_the_slack_real-time_messaging_api/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-05-23T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-05-23T00:00:00+00:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://jmangold23.github.io/mangoldaiwiki/"><img class="app-header-avatar" src="/mangoldaiwiki/avatar.jpg" alt="John Doe" /></a>
      <span class="app-header-title">mangoldai :: cloud architect insights</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/mangoldaiwiki/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/mangoldaiwiki/tags/">Tags</a>
      </nav>
      <p>Cloud architecture, Azure, and tech innovations. Notes, tips, and insights.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/jmangold23" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>My Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://www.linkedin.com/in/joshua-mangold-a7ba0989/" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>My LinkedIn</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Powershell-SlackBot- Harnessing the Power of the Slack Real-Time Messaging API</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          May 23, 2024
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          2 min read
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://jmangold23.github.io/mangoldaiwiki/tags/powershell/">PowerShell</a>
              <a class="tag" href="https://jmangold23.github.io/mangoldaiwiki/tags/slack/">Slack</a>
              <a class="tag" href="https://jmangold23.github.io/mangoldaiwiki/tags/chatbot/">Chatbot</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <h2 id="powershell-slackbot-harnessing-the-power-of-the-slack-real-time-messaging-api">Powershell-SlackBot: Harnessing the Power of the Slack Real-Time Messaging API</h2>
<p>This project is a PowerShell implementation of a Chat Bot for Slack that utilises the Slack Real Time Messaging (RTM) API. This code is intended to provide a simple framework for anyone that wants to write a Chat Bot for a single Slack Team that is able to respond to Channel and Direct Messages. It would also be simple to extend the code to permit the Bot to respond to any other events exposed via the RTM API.</p>
<h3 id="requirements">Requirements</h3>
<p>This script uses the .NET class: System.Net.WebSockets.WebSocket. As such the code has to be run on Windows 8 / Server 2012 or newer operating systems.</p>
<h3 id="getting-started">Getting Started</h3>
<p>To get started with this project, you&rsquo;ll first need to create a Bot under Custom Integrations &gt; Bots in your Slack account. Once you have done that, you&rsquo;ll need to obtain the API token for your Bot, which can be passed to the <code>Invoke-SlackBot</code> cmdlet as a parameter or read from an XML file created via <code>$Token | Export-CliXML</code>.</p>
<p>If you&rsquo;re running PowerShell 5, you can install the <a href="https://www.powershellgallery.com/packages/SlackBot/1.0.16">SlackBot module from the PowerShell Gallery</a> using the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Install-Module -Name SlackBot
</code></pre></div><p>Alternatively, you can download or clone the module folder from the <a href="https://github.com/KevinMarquette/PSSlackBot">GitHub repository</a> and copy it to your modules directory. Then, you can load the module with the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Import-Module SlackBot
</code></pre></div><p>Once you have the module loaded, you can start the Bot by executing the following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">Invoke-SlackBot -token <span style="color:#e6db74">&#34;yourtoken&#34;</span>
</code></pre></div><p>The bot will generate a log file by default in your User Profile directory (C:\Users\youruser) under \Logs, and all log messages will also appear in the console as either PowerShell standard Verbose, Warning or Error output.</p>
<p>The bot is currently configured to respond to any Direct Messages, or any conversation that includes @botname (whatever you named your Bot) as any word of the message.</p>
<h3 id="extending-the-script">Extending the script</h3>
<p>There are two obvious places to extend the script:</p>
<ol>
<li>
<p>Add additional conditions in the <code>Switch($words)</code> statement and any code that you want executed when those conditions are matched. Currently, it splits the message into an Array of <code>$words</code>, but you may want to instead match the full <code>.text</code> response of the message.</p>
</li>
<li>
<p>Add additional conditions in the <code>Switch($RTM)</code> statement to match other RTM API events. See the <a href="https://api.slack.com/rtm">RTM API documentation</a> for a full list of events.</p>
</li>
</ol>
<h3 id="contributions">Contributions</h3>
<p>The author welcomes contributions to this project. If you have any ideas or improvements, feel free to submit a pull request or open an issue on the <a href="https://github.com/KevinMarquette/PSSlackBot">GitHub repository</a>.</p>

    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
